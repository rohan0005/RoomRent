{% extends 'Admin/NavigationBarBase/base.html' %}
{% load static %}
{% block title %}RoomRent | Dashboard{% endblock %}
{% block content %}
  
{% if allPendingRooms %}


</div>

    <!-- START: ROOMS, order and pending request information section -->
    <div class="bg-[#F3F3F3] ">
        <div class="container pb-36 bg-white px-6 py-1 mx-auto">
            <div class="flex justify-between">
                <div>
                    <h3 class="text-3xl font-semibold text-gray-700 p-5">Pending Rooms</h3>
                </div>

                {% if messages %}
                {% for message in messages %}
                    <!-- Success or error message start -->
                    <div id="toast-success" class="flex h-12 md:w-[250px]  mt-4">
                        <!-- ICON -->
                        <div class="rounded-l-lg  w-1/5 flex justify-center p-2 {% if message.tags == 'alert-danger' %}bg-red-500 text-white{% else %}bg-[#59CE8F] text-white{% endif %}">
                            {% if message.tags == 'alert-danger' %}
                            <span class="pt-1">
                                <svg width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M11.5001 4.59961C11.8051 4.59961 12.0976 4.72077 12.3133 4.93644C12.5289 5.1521 12.6501 5.44461 12.6501 5.74961V12.6496C12.6501 12.9546 12.5289 13.2471 12.3133 13.4628C12.0976 13.6784 11.8051 13.7996 11.5001 13.7996C11.1951 13.7996 10.9026 13.6784 10.6869 13.4628C10.4713 13.2471 10.3501 12.9546 10.3501 12.6496V5.74961C10.3501 5.44461 10.4713 5.1521 10.6869 4.93644C10.9026 4.72077 11.1951 4.59961 11.5001 4.59961ZM11.5001 16.0996C11.1951 16.0996 10.9026 16.2208 10.6869 16.4364C10.4713 16.6521 10.3501 16.9446 10.3501 17.2496C10.3501 17.5546 10.4713 17.8471 10.6869 18.0628C10.9026 18.2785 11.1951 18.3996 11.5001 18.3996C11.8051 18.3996 12.0976 18.2785 12.3133 18.0628C12.5289 17.8471 12.6501 17.5546 12.6501 17.2496C12.6501 16.9446 12.5289 16.6521 12.3133 16.4364C12.0976 16.2208 11.8051 16.0996 11.5001 16.0996Z" fill="white"/>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 0C5.14855 0 0 5.14855 0 11.5C0 17.8514 5.14855 23 11.5 23C17.8514 23 23 17.8514 23 11.5C23 5.14855 17.8514 0 11.5 0ZM2.3 11.5C2.3 13.94 3.26928 16.28 4.99462 18.0054C6.71995 19.7307 9.06001 20.7 11.5 20.7C13.94 20.7 16.28 19.7307 18.0054 18.0054C19.7307 16.28 20.7 13.94 20.7 11.5C20.7 9.06001 19.7307 6.71995 18.0054 4.99462C16.28 3.26928 13.94 2.3 11.5 2.3C9.06001 2.3 6.71995 3.26928 4.99462 4.99462C3.26928 6.71995 2.3 9.06001 2.3 11.5Z" fill="white"/>
                                    </svg>                                    
                            </span>
                            {% else %}

                            <span>
                                <svg width="35" height="35" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.5001 2.91602C9.47925 2.91602 2.91675 9.47852 2.91675 17.4993C2.91675 25.5202 9.47925 32.0827 17.5001 32.0827C25.5209 32.0827 32.0834 25.5202 32.0834 17.4993C32.0834 9.47852 25.5209 2.91602 17.5001 2.91602ZM17.5001 29.166C11.0688 29.166 5.83341 23.9306 5.83341 17.4993C5.83341 11.0681 11.0688 5.83268 17.5001 5.83268C23.9313 5.83268 29.1667 11.0681 29.1667 17.4993C29.1667 23.9306 23.9313 29.166 17.5001 29.166ZM24.1938 11.0535L14.5834 20.6639L10.8063 16.9014L8.75008 18.9577L14.5834 24.791L26.2501 13.1243L24.1938 11.0535Z" fill="white"/>
                                </svg>
                            </span>
                            {% endif %}
                        </div>

                        <!-- MEssage -->
                        <div class="border-[#CECECE] border-l-0 w-4/5 p-3 border outline-none">
                            <p class="left-0 {% if message.tags == 'alert-success' %}  text-[#0AD674] {% else %} text-[#FF3131]{% endif %} font-medium lg:text-[15px] text-[15px]">
                                    {{message}}
                        </div>
                    </div>
                   

                    {% endfor %}
                    {% endif %}
            </div>

            <div>

                <div class="px-3 py-4 flex justify-center">
                    <table class="w-full text-md bg-white shadow-md rounded mb-4">
                        <tbody>
                            <tr class="border-b">
                                <th class="text-left p-3 px-5">S.N</th>
                                <th class="text-left p-3 px-5">Username</th>
                                <th class="text-left p-3 px-5">Room Title</th>
                                <th class="text-left p-3 px-5">Requested on</th>
                                <th class="text-left p-3 px-5"></th>
                                <th></th>
                            </tr>
                            
                            {% if allPendingRooms %}
                            <!-- Show the verified users from the allVerifiedUsers which we have pass in context -->
                            {% for room in allPendingRooms %}

                               <tr class="border-b hover:bg-gray-100">
                                   <td class="p-3 px-5">
                                       <p><p>{{ forloop.counter }}</p></p>
                                   </td>
                                   <td class="p-3 px-5">
                                       <p>{{room.user}}</p>
                                   </td>
                                   <td class="p-3 px-5">
                                       <p>{{room.roomTitle}}</p>
                                   </td>
                                   <td class="p-3 px-5">
                                       <p>{{room.listed_date}}</p>
                                   </td>
                                   <td class="p-3 px-5 pl-3">

                                <!-- Modal toggle -->
                                <button data-modal-target="popup-modal-{{ room.id }}" data-modal-toggle="popup-modal-{{ room.id }}" class="mr-3 text-sm bg-gray-700 hover:bg-gray-600 text-white py-2 px-3 rounded focus:outline-none focus:shadow-outline" type="button">
                                    View details
                                </button>

                            </td>
                               </tr>  
                               
                                <!-- view Modal -->
                               <!-- Main modal -->
                                <div id="popup-modal-{{ room.id }}" data-modal-backdrop="popup-modal-{{ room.id }}" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                                    <div class="relative p-4 w-full max-w-2xl max-h-full">
                                        <!-- Modal content -->
                                        <div class="relative bg-white rounded-lg shadow">
                                            <!-- Modal header -->
                                            <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t ">
                                                <h3 class="text-xl font-semibold text-gray-900">
                                                    <p>{{room.roomTitle}}</p>
                                                </h3>
                                                <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center " data-modal-hide="popup-modal-{{ room.id }}">
                                                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                                    </svg>
                                                    <span class="sr-only">Close modal</span>
                                                </button>
                                            </div>
                                            <!-- Modal body -->
                                            <div class="p-4 md:p-5 space-y-4">
                                                <p class="text-base leading-relaxed text-gray-500 ">
                                                    <span class="text-gray-900">Uploaded by: </span> {{room.user}}
                                                </p>
                                                <p class="text-base leading-relaxed text-gray-500 ">
                                                    <span class="text-gray-900">Room address: </span> {{room.roomAddress}}
                                                </p>

                                                <p class="text-base leading-relaxed text-gray-500 ">
                                                    <span class="text-gray-900 font-bold"> Document picture </span>
                                                </p>

                                                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-2">
                                                    {% for img in room.documents.all %}
                                                    <div>
                                                        <a href="{{img.document.url}}" target="_blank">
                                                            <img class="h-auto max-w-full rounded-lg" src="{{ img.document.url }}" alt="img">
                                                        </a>
                                                    </div>
                                                    {% endfor %}
                                                </div>

                                            </div>
                                            <!-- Modal footer -->
                                            <div class="flex p-4 md:p-5 border-t border-gray-200 rounded-b ">

                                                <form action="" method="post" class="ml-auto">
                                                    {% csrf_token %}
                                                        <input type="hidden" name="room_id" value="{{ room.id }}">
                                                       
                                                        <button data-modal-hide="popup-modal-{{ room.id }}" type="submit"  name="approve" class="text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">Approve</button>
                                                        <button data-modal-hide="popup-modal-{{ room.id }}" type="submit" name="reject" class="ms-3 text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 ">Reject</button>

                                                    </form>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                             
                            {% endfor %}  
                            {% endif %}                      
                        </tbody>
                    </table>
                </div>
            </div>






            <div class="flex flex-col xs:flex-row items-center xs:justify-between">
                <div class="inline-flex mt-2 xs:mt-0 gap-4 ">
                    <!-- Pagination Next and Previous -->
                    {% if allPendingRooms.has_previous %}
                        <a href="?page={{ allPendingRooms.previous_page_number }}"
                        class="text-sm bg-gray-300 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded">
                            Prev
                        </a>
                    {% else %}
                        <button class="text-sm bg-gray-300 text-gray-500 font-semibold py-2 px-4 rounded" disabled>
                            Prev
                        </button>
                    {% endif %}
            
                    {% if allPendingRooms.has_next %}
                        <a href="?page={{ allPendingRooms.next_page_number }}"
                        class="text-sm bg-gray-300 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded">
                            Next
                        </a>
                    {% else %}
                        <button class="text-sm bg-gray-300 text-gray-500 font-semibold py-2 px-4 rounded" disabled>
                            Next
                        </button>
                    {% endif %}
                </div>
            </div>


    {% else %}

    <h1 class="text-3xl ">
        Room - Requests
    </h1>

    <p class="text-2xl font-regular flex justify-center mt-10">
        You have no pending rooms
    </p>

    {% endif %}


        </div>
    </div>





{% endblock %}
        
