{% extends 'Admin/NavigationBarBase/base.html' %}
{% load static %}
{% block title %}RoomRent | Dashboard{% endblock %}
{% block content %}
  


      <!-- START: ROOMS, order and pending request information section -->
      <div class="flex-1 bg-[#F3F3F3] ">
        <div class="container px-6 py-1 mx-auto">
          <div class="flex gap-[590px]">

            <div>
              <h3 class="text-3xl font-medium text-gray-700">Dashboard</h3>
            </div>
            <!-- Display the message  -->
            <div id="toast-success">
              {% if messages %} {% for message in messages %}
                  <div class="w-[400px] ml-6">
                    <div
                      class="p-3 mb-3 text-sm rounded-lg bg-[#59CE8F] text-white"
                      role="alert">
                      <span class="font-medium">{{message}}</span>
                    </div>
                  </div>

                  {% endfor %} {% endif %}
            </div>
        
          </div>


          <div class="mt-4">
                <div class="flex flex-wrap -mx-6">
                    <div class="w-full px-6 sm:w-1/2 xl:w-1/3">
                        <div class="flex items-center px-5 py-4 bg-white rounded-md shadow-sm">
                            <div class="p-3 rounded-full">
                                <img src="images/static images/Icons/userIcon1.svg" alt="">
                            </div>

                            <div class="mx-5">
                                <!-- Show total verified users -->
                                <h4 class="text-2xl font-semibold text-gray-700">{{totalVerifiedUsers}}</h4> 
                                <div class="text-gray-500"><a href="{% url 'adminDashboard' %}">Verified Users</a></div>
                            </div>
                        </div>
                    </div>

                    <div class="w-full px-6 mt-6 sm:w-1/2 xl:w-1/3 sm:mt-0">
                        <div class="flex items-center px-5 py-4 bg-white rounded-md shadow-sm">
                            <div class="p-3 rounded-full">
                                <img src="images/static images/Icons/house.svg" alt="">
                            </div>

                            <div class="mx-5">
                                <!-- Show total rooms -->
                                <h4 class="text-2xl font-semibold text-gray-700">0</h4>
                                <div class="text-gray-500"><a href="#">Total Rooms</a></div>
                            </div>
                        </div>
                    </div>

                    <div class="w-full px-6 mt-6 sm:w-1/2 xl:w-1/3 xl:mt-0">
                        <div class="flex items-center px-5 py-4 bg-white rounded-md shadow-sm">
                            <div class="p-3 rounded-full">
                                <img src="images/static images/Icons/pending1.svg" alt="">
                            </div>

                            <div class="mx-5">
                                <!-- show pending requests -->
                                <h4 class="text-2xl font-semibold text-gray-700">{{totalUsersWhoRequestForOwner}}</h4>
                                <div class="text-gray-500"><a href="{% url 'pendingRequests' %}">Pending requests</a></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

<!-- If the db have some users  -->
{% if allVerifiedUsers %}
             <!-- component -->
             <div class="text-gray-900 bg-[#F3F3F3]">
                 <div class="pl-4 pt-2 flex">
                     <h1 class="text-3xl">
                         Users
                     </h1>
                 </div>
                 <div class="px-3 py-4 flex justify-center">
                     <table class="w-full text-md bg-white shadow-md rounded mb-4">
                         <tbody>
                             <tr class="border-b">
                                 <th class="text-left p-3 px-5">S.N</th>
                                 <th class="text-left p-3 px-5">Username</th>
                                 <th class="text-left p-3 px-5">User type</th>
                                 <th class="text-left p-3 px-5">Contact</th>
                                 <th class="text-left p-3 px-5"></th>
                                 <th></th>
                             </tr>
                             
                             <!-- Show the verified users from the allVerifiedUsers which we have pass in context -->
                             {% for verifiedUser in allVerifiedUsers %}

                                <tr class="border-b hover:bg-gray-100">
                                    <td class="p-3 px-5">
                                        <p><p>{{ forloop.counter }}</p></p>
                                    </td>
                                    <td class="p-3 px-5">
                                        <p>{{verifiedUser.username}}</p>
                                    </td>
                                    <td class="p-3 px-5">
                                        <p>{{verifiedUser.groups.first.name}}</p>
                                    </td>
                                    <td class="p-3 px-5">
                                        <p>{{verifiedUser.useradditionaldetail.contact_number}}</p>
                                    </td>
                                    <td class="p-3 px-5 pl-3"><button
                                            type="button"
                                            data-modal-target="popup-modal-{{ verifiedUser.username }}" data-modal-toggle="popup-modal-{{ verifiedUser.username }}" 
                                            class="py-1 px-2 focus:outline-none focus:shadow-outline "><img src="images/static images/Icons/remove.png" alt="">
                                        </button>
                                    </td>
                                </tr>                                
                                  <!-- START: DELETE user -->
                                  <form action="" method="post">
                                    {% csrf_token %}
                                  <div id="popup-modal-{{ verifiedUser.username }}" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                                      <div class="relative p-4 w-full max-w-md max-h-full">
                                          <div class="relative bg-white rounded-lg shadow ">
                                              <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center " data-modal-hide="popup-modal-{{ verifiedUser.username }}">
                                                  <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                                  </svg>
                                                  <span class="sr-only">Close modal</span>
                                              </button>
                                              <div class="p-4 md:p-5 text-center">
                                                  <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 " aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                                                  </svg>
                                                  <h3 class="mb-5 text-lg font-normal text-gray-500 ">Are you sure you want to delete this user?</h3>
                                                  <input type="hidden" name="user" value="{{ verifiedUser.username }}">
                                                  <button  name="deleteUser" data-modal-hide="popup-modal-{{ verifiedUser.username }}" type="submit" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center me-2">
                                                      Yes, I'm sure
                                                  </button>
                                                  <button data-modal-hide="popup-modal-{{ verifiedUser.username }}" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 ">No, cancel</button>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                                </form>
                                  <!--END:  DELETE USER -->                                
                             {% endfor %}                        
                         </tbody>
                     </table>
                 </div>
             </div>

             <div
                 class="flex flex-col xs:flex-row items-center xs:justify-between">
                 <div class="inline-flex mt-1 xs:mt-0 gap-4 ">

                    {% if allVerifiedUsers.has_previous %}
                        <a href="?page={{ allVerifiedUsers.previous_page_number }}"
                        class="text-sm bg-gray-300 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded">
                            Prev
                        </a>
                    {% else %}
                        <button class="text-sm bg-gray-300 text-gray-500 font-semibold py-2 px-4 rounded" disabled>
                            Prev
                        </button>
                    {% endif %}

                    {% if allVerifiedUsers.has_next %}
                        <a href="?page={{ allVerifiedUsers.next_page_number }}"
                        class="text-sm bg-gray-300 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded">
                            Next
                        </a>
                    {% else %}
                        <button class="text-sm bg-gray-300 text-gray-500 font-semibold py-2 px-4 rounded" disabled>
                            Next
                        </button>
                    {% endif %}
                                         
                 </div>
             </div>
         </div>
     </div>

<!-- IF  0 users then show this message -->
{% else %}

<p class="text-2xl font-regular p-20 pl-[400px] ">
  Room Rent have 0 users
</p>


{% endif %}

     <!-- END: TABLE -->
      {% endblock %}     