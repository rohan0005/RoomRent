{% extends 'Users Profile/NavigationBarBase/base.html' %} {% load static %} 
{% block title %}RoomRent | View Booking {% endblock %}

{% block content %}

<div class="flex-1 bg-[#F3F3F3]">
  <!-- Main container Start -->
  <div class="container px-4 py-1 mx-auto">
    <!-- HEADING CONTENTS -->
    <div
      class="bg-white h-screen pb-[100px] lg:mr-3 mt-[92px] md:ml-30 lg:ml-60 bg-white"
    >
      <!--HEADING-->
      <div class="flex justify-between pr-3 bg-[#0766AD] text-white">
        <div>
          <h1 class="font-semibold text-[17px] md:text-3xl p-6">Bookings</h1>
        </div>

        <div>
          
          <!--{% if messages %}

          
          {% for msg in messages %}
            <h1 class="font-medium text-[14px] md:text-[17px] p-6 ">{{msg}}</h1>
          {% endfor %}
            
            
          {% endif %} -->


          {% for message in messages %}
                    <!-- Success or error message start -->
                    <div id="toast-success" class="flex h-12 md:w-[250px]  mt-4">
                        <!-- ICON -->
                        <div class="rounded-l-lg  w-1/5 flex justify-center p-2 {% if message.tags == 'alert-danger' %}bg-red-500 text-white{% else %}bg-[#0AD674] text-white{% endif %}">
                            {% if message.tags == 'alert-danger' %}
                            <span class="pt-1">
                                <svg width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M11.5001 4.59961C11.8051 4.59961 12.0976 4.72077 12.3133 4.93644C12.5289 5.1521 12.6501 5.44461 12.6501 5.74961V12.6496C12.6501 12.9546 12.5289 13.2471 12.3133 13.4628C12.0976 13.6784 11.8051 13.7996 11.5001 13.7996C11.1951 13.7996 10.9026 13.6784 10.6869 13.4628C10.4713 13.2471 10.3501 12.9546 10.3501 12.6496V5.74961C10.3501 5.44461 10.4713 5.1521 10.6869 4.93644C10.9026 4.72077 11.1951 4.59961 11.5001 4.59961ZM11.5001 16.0996C11.1951 16.0996 10.9026 16.2208 10.6869 16.4364C10.4713 16.6521 10.3501 16.9446 10.3501 17.2496C10.3501 17.5546 10.4713 17.8471 10.6869 18.0628C10.9026 18.2785 11.1951 18.3996 11.5001 18.3996C11.8051 18.3996 12.0976 18.2785 12.3133 18.0628C12.5289 17.8471 12.6501 17.5546 12.6501 17.2496C12.6501 16.9446 12.5289 16.6521 12.3133 16.4364C12.0976 16.2208 11.8051 16.0996 11.5001 16.0996Z" fill="white"/>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 0C5.14855 0 0 5.14855 0 11.5C0 17.8514 5.14855 23 11.5 23C17.8514 23 23 17.8514 23 11.5C23 5.14855 17.8514 0 11.5 0ZM2.3 11.5C2.3 13.94 3.26928 16.28 4.99462 18.0054C6.71995 19.7307 9.06001 20.7 11.5 20.7C13.94 20.7 16.28 19.7307 18.0054 18.0054C19.7307 16.28 20.7 13.94 20.7 11.5C20.7 9.06001 19.7307 6.71995 18.0054 4.99462C16.28 3.26928 13.94 2.3 11.5 2.3C9.06001 2.3 6.71995 3.26928 4.99462 4.99462C3.26928 6.71995 2.3 9.06001 2.3 11.5Z" fill="white"/>
                                    </svg>                                    
                            </span>
                            {% else %}

                            <span>
                                <svg width="35" height="35" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.5001 2.91602C9.47925 2.91602 2.91675 9.47852 2.91675 17.4993C2.91675 25.5202 9.47925 32.0827 17.5001 32.0827C25.5209 32.0827 32.0834 25.5202 32.0834 17.4993C32.0834 9.47852 25.5209 2.91602 17.5001 2.91602ZM17.5001 29.166C11.0688 29.166 5.83341 23.9306 5.83341 17.4993C5.83341 11.0681 11.0688 5.83268 17.5001 5.83268C23.9313 5.83268 29.1667 11.0681 29.1667 17.4993C29.1667 23.9306 23.9313 29.166 17.5001 29.166ZM24.1938 11.0535L14.5834 20.6639L10.8063 16.9014L8.75008 18.9577L14.5834 24.791L26.2501 13.1243L24.1938 11.0535Z" fill="white"/>
                                </svg>
                            </span>
                            {% endif %}
                        </div>

                        <!-- MEssage -->
                        <div class="border-[#CECECE] border-l-0 w-4/5 p-3 border outline-none">
                            <p class="left-0  font-medium md:text-[15px] text-[13px]">
                                    {{message}}
                        </div>
                    </div>
                   

                    {% endfor %}
            
        </div>
      </div>

      <!-- BOOKING LISTS -->
    <div class="md:px-10 mt-5">

       
       {% if pendingBookings %}
    
      <table class="md:w-full w-full md:text-md text-sm bg-white shadow-md rounded mb-4">
        <tbody>
          <tr class="border-b">
            <th class="text-left p-3 px-5">Username</th>
            <th class="text-left p-3 px-5">Booked on</th>
            <th class="text-left p-3 px-5">Contact</th>
            <th class="text-left p-3 px-5"></th>
          </tr>

          {% for room in pendingBookings %}
          <tr class="border-b hover:bg-gray-100">
           
            <td class="p-3 px-5">
              <p>{{room.user}}</p>
            </td>
            <td class="p-3 px-5">
              <p>{{room.bookingDate }}</p>
            </td>
            <td class="p-3 px-5">
              <p>{{room.user.useradditionaldetail.contact_number}}</p>
            </td>
            <td class="p-3 px-5 pl-3">
              <button
                type="button"
                class="md:mr-3 text-sm bg-gray-700 hover:bg-gray-600 text-white md:py-2 md:px-3 rounded focus:outline-none focus:shadow-outline"
                data-modal-target="medium-modal-{{ room.id }}"
                data-modal-toggle="medium-modal-{{ room.id }}"
              >
                View details
              </button>
            </td>
          </tr>

          <!-- view Modal -->
          <div
            id="medium-modal-{{ room.id }}"
            tabindex="-1"
            class="fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full"
          >
            <div class="relative w-full max-w-2xl max-h-full">
              <!-- Modal content -->
              <div class="relative bg-white rounded-lg shadow">
                <!-- Modal header -->
                <div
                  class="flex items-center justify-between p-4 md:p-5 border-b rounded-t"
                >
                  <h3 class="text-xl font-medium text-gray-900">
                    Booking details
                  </h3>
                  <button
                    type="button"
                    class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center"
                    data-modal-hide="medium-modal-{{ room.id }}"
                  >
                    <svg
                      class="w-3 h-3"
                      aria-hidden="true"
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 14 14"
                    >
                      <path
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
                      />
                    </svg>
                    <span class="sr-only">Close modal</span>
                  </button>
                </div>
                <form action="" method="post" class="ml-auto">
                  {% csrf_token %}
                <!-- Modal body -->
                <div class="p-4 ">

                    <!--ROOM Details-->
                    <div>

                        <h1 class="font-bold">Room details</h1>

                        <div class="mt-4">
                            <h1><span>Room Name: </span> <span><a class="text-[#0766AD]" href="{% url 'roomMoreDetails' room.room.id  %}">{{room.room.roomTitle}}</a></span></h1> 
                        </div>

                        <div class="mt-4">
                          <h1><span>Movein date: </span> <span>{{room.moveInDate|date}}</span></h1> 
                      </div>

                        <div>

                        </div>

                    </div>

                    <!--User Details-->
                    <div class="mt-5 ">

                        <h1 class="font-bold">User details</h1>

                        <div class="mt-4">
                            
                            {% if room.user.first_name and room.user.last_name %}   <h1 class="pb-2"><span>Name: </span> <span>{{room.user.first_name}}</span> <span>{{room.user.last_name}}</span></h1>   {% endif %}
                            <h1  class="pb-2"><span>Username: </span> <span>{{room.user}}</span></h1> 
                            <h1  class="pb-2"><span>Contact Number: </span> <span>{{room.user.useradditionaldetail.contact_number}}</span></h1> 
                            <h1><span>Email: </span> <span>{{room.user.email}}</span></h1> 

                        </div>

                        {% if room.user.userprofilepicture %}
                        <div class="mt-5">

                            <h1 class="font-bold pb-2">User Profile Picture</h1>

                            <div class="flex justify-center">
                            <a href="{{ room.user.userprofilepicture.image.url }}" target="_blank">
                                <img
                                class="h-64 max-w-full rounded-lg"
                                src="{{ room.user.userprofilepicture.image.url }}"
                                alt="img"
                                />
                            </a>
                            </div>

                        </div>
                        {% endif %}
                        
                        <!--FOR UPDATING ELECTRICITY UNIT-->
                        <div class="">
                          
                          <div> 
                            <label for="email" class="block mb-2 text-red-400">Check and update the electricity unit (*)</label>
                            <input type="number" name="previousElectricityUnit" class="placeholder-red-400  bg-red-50 border border-red-500 text-red-900 text-sm rounded-lg focus:ring-red-500 block w-64 p-2.5 " placeholder="Current electricity unit" min=1 required />
                        </div>
                        </div>
 
                        
                    </div>

                </div>
                <!-- Modal footer -->
                
                  <div
                    class="flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b"
                  >
                    <input
                      type="hidden"
                      name="roomId"
                      value="{{ room.id }}"
                    />
                    <input
                      type="hidden"
                      name="user"
                      value="{{ room.user.id }}"
                    />
                    <button
                      data-modal-hide="medium-modal-{{ room.id }}"
                      type="submit"
                      name="accept"
                      class="text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"
                    >
                      Approve
                    </button>
                    <button
                      data-modal-hide="medium-modal-{{ room.id }}"
                      type="submit"
                      name="reject"
                      class="ms-3 text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10"
                    >
                      Reject
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          {% endfor %}
        </tbody>
      </table>

      {% else %}

      <h1 class="text-xl">No bookings currently</h1>

      {% endif %}
         







    </div>
    </div>
  </div>
</div>

{% endblock %}
